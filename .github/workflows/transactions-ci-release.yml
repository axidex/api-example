name: Build Transactions Release

on:
  push:
    branches: ['release/**']
    paths: ['transactions/**']
  pull_request:
    branches: ['release/**']
    paths: ['transactions/**']
  workflow_dispatch:

jobs:
  call-ci:
    uses: ./.github/workflows/go-ci.yml
    with:
      service_dir: 'transactions'

  build:
    needs: [ call-ci ]
    uses: ./.github/workflows/docker-build-release.yml
    with:
      service_dir: 'transactions'
      docker_image_name: 'api-example-transactions'
      create_tag: true
      tag_prefix: 'v'
    secrets:
      DOCKER_USERNAME: ${{ secrets.DOCKER_USERNAME }}
      DOCKER_PASSWORD: ${{ secrets.DOCKER_PASSWORD }}
